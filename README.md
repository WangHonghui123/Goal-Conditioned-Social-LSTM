# Goal-Conditioned-Social-LSTM
This is my trial to use goal predictor in the Social-LSTM algorithm for complete normalized pedestrian trajectory prediction (20 frames). 
In this repository, The goal estimator is from this paper:
```bibtex
@inproceedings{he2021where,
  title={Where are you heading? Dynamic Trajectory Prediction with Expert Goal Examples},
  author={He, Zhao and Richard P. Wildes},
  booktitle = {Proceedings of the International Conference on Computer Vision (ICCV)},
  month = {Oct.},
  year={2021}
}
```
## The aim of this repository
In this repository, I would like to look into the effect of end-point information (ground truth end point and predicted end point)
on the pedestrian trajectory prediction. The effect of end-point information will be added to my master's thesis.

## Introduction
Goal-conditioned deep learning methods, including Goal-conditioned Social-LSTM method, use ground truth end points during training 
since the ground truth point during training is know. During test, the goal predictor is used firstly since the end points are unknown. And then 
trajectory predictor is used afterwards.

In this repository, we use the goal-shift method to endow the complete normalized pedestrian trajectory with end-point information. 
Note that during training, we all use ground truth end points in the goal-shift method, while the predicted end point generated by goal predictor and
ground truth end point are used respectively during test, for the sake of looking into the effect of goal information in the pedestrian trajectory prediction

## Result
The result of Social-LSTM algorithm on normalized complete trajectory prediction and non-normalized complete trajectory prediction are shown as follows:

**ADE:**
Average Displacement Error (ADE) is the mean square error (MSE) over all estimated points of a trajectory and true points.

| **Dataset**                           | **Social-LSTM (Non normalized)** | **Social-LSTM (Non normalized)**  |
| --------------------------------- | --------- |-----------------|
| **ETH**                     | 4.0781  |**1.9927**|
| **HOTEL**                     | 6.8003   |**1.4552**|
| **ZARA1**                     | 2.0111   |**1.7175**|
| **ZARA2**                     |  2.0794  |**1.3038**|
| **UNIV**                     | 3.9830   |**1.9072**|
| **Average**                     | 3.7904   |**1.6753**|

**FDE:**
FInal Displacement Error (FDE) is the distance between predicted final destination and true final destination at the end of prediction period (20 frames)
| **Dataset**                           | **Social-LSTM (Non normalized)** | **Social-LSTM (Non normalized)**  |
| --------------------------------- | --------- |-----------------|
| **ETH**                     | 5.2299  |**3.5463**|
| **HOTEL**                     | 8.3780   |**2.4048**|
| **ZARA1**                     | 3.1692   |**2.9853**|
| **ZARA2**                     |  3.2690  |**2.2892**|
| **UNIV**                     | 5.5075   |**3.2343**|
| **Average**                     | 5.1107   |**2.8920**|


