# Goal-Conditioned Social-LSTM
This is my trial to use goal predictor in the Social-LSTM algorithm for complete normalized pedestrian trajectory prediction (20 frames). 
In this repository, The goal estimator is from this paper:
```bibtex
@inproceedings{he2021where,
  title={Where are you heading? Dynamic Trajectory Prediction with Expert Goal Examples},
  author={He, Zhao and Richard P. Wildes},
  booktitle = {Proceedings of the International Conference on Computer Vision (ICCV)},
  month = {Oct.},
  year={2021}
}
```
## The aim of this repository
In this repository, I would like to look into the effect of end-point information (ground truth end point and predicted end point)
on the pedestrian trajectory prediction. The effect of end-point information will be added to my master's thesis.

## Introduction
Goal-conditioned deep learning methods, including Goal-conditioned Social-LSTM method, use ground truth end points during training 
since the ground truth point during training is know. During test, the goal predictor is used firstly since the end points are unknown. And then 
trajectory predictor is used afterwards.

In this repository, we use the goal-shift method to endow the complete normalized pedestrian trajectory with end-point information. 
Note that during training, we all use ground truth end points in the goal-shift method, while the predicted end point generated by goal predictor and
ground truth end point are used respectively during test, for the sake of looking into if the predicted goal or ground truth goal can attract the trajectory towards the ground truth end points. 

## Result
The result of Goal-Conditioned Social-LSTM methods using predicted goal and ground truth goal for complete normalized pedestrian trajectory prediction (20 frames) are shown as follows:

Note that Goal-Conditioned Social-LSTM A means using ground truth goal during test; Goal-Conditioned Social-LSTM B means using predicted goal during test

**ADE:**
Average Displacement Error (ADE) is the mean square error (MSE) over all estimated points of a trajectory and true points.

Note that the normalized Social-LSTM is added to see if the goal information can improve the ADE.

| **Dataset**                           | **Goal-Conditioned Social-LSTM A** | **Goal-Conditioned Social-LSTM B**  | Social-LSTM |
| --------------------------------- | --------- |-----------------| ----------------|
| **ETH**                     | 4.4013  |**3.8677**| 1.9927|
| **HOTEL**                     | 5.3760   |**5.2482**|1.4552|
| **ZARA1**                     | 4.1749   |**3.7574**|1.7175|
| **ZARA2**                     |  **3.8424**  |4.1727|1.3038|
| **UNIV**                     | **3.9242**  |4.0282|1.9072|
| **Average**                     | 4.3438  |**4.2148**|1.6753|


**FDE:**
FInal Displacement Error (FDE) is the distance between predicted final destination and true final destination at the end of prediction period (20 frames)

Note that the normalized Social-LSTM is added to see if the goal information can improve the FDE.


| **Dataset**                           | **Goal-Conditioned Social-LSTM A** | **Goal-Conditioned Social-LSTM B**  |**Social-LSTM**|
| --------------------------------- | --------- |-----------------|------|
| **ETH**                     | 6.0305  |**5.2809**|3.5463|
| **HOTEL**                     | 6.3336   |**6.1913**|2.4048|
| **ZARA1**                     | 5.7317   |**5.1891**|2.9853|
| **ZARA2**                     |  **5.3070**  |5.3587|2.2892|
| **UNIV**                     | 5.0127  |**5.0815**|3.2343|
| **Average**                     | 5.6831   |**5.4203**|2.8920|


